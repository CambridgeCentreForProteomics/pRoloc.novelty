<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bayesian spatial proteomics with pRoloc â€¢ pRoloc</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian spatial proteomics with pRoloc">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">pRoloc</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.21.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/pRoloc-bayesian.html">Bayesian spatial proteomics with pRoloc</a>
    </li>
    <li>
      <a href="../articles/pRoloc-goannotations.html">Annotating spatial proteomics data</a>
    </li>
    <li>
      <a href="../articles/pRoloc-ml.html">Machine learning techniques available in pRoloc</a>
    </li>
    <li>
      <a href="../articles/pRoloc-transfer-learning.html">A transfer learning algorithm for spatial proteomics</a>
    </li>
    <li>
      <a href="../articles/pRoloc-tutorial.html">Using pRoloc for spatial proteomics data analysis</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lgatto/pRoloc">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Bayesian spatial proteomics with pRoloc</h1>
                        <h4 class="author">Oliver Crook</h4>
                                    <h4 class="author">Laurent Gatto</h4>
                        
      
      <small class="dont-index">Source: <a href="https://github.com/lgatto/pRoloc/blob/master/vignettes/pRoloc-bayesian.Rmd"><code>vignettes/pRoloc-bayesian.Rmd</code></a></small>
      <div class="hidden name"><code>pRoloc-bayesian.Rmd</code></div>

    </div>

    
    
<script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  document.querySelector("h1").className = "title";
});
</script><script type="text/javascript">
document.addEventListener("DOMContentLoaded", function() {
  var links = document.links;  
  for (var i = 0, linksLength = links.length; i < linksLength; i++)
    if (links[i].hostname != window.location.hostname)
      links[i].target = '_blank';
});
</script><div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>For an in-depth description of the infrastructure for Bayesian spatial proteomics, please see</p>
<blockquote>
<p>A Bayesian Mixture Modelling Approach For Spatial Proteomics Oliver M Crook, Claire M Mulvey, Paul D. W. Kirk, Kathryn S Lilley, Laurent Gatto bioRxiv 282269; doi: <a href="https://doi.org/10.1101/282269" class="uri">https://doi.org/10.1101/282269</a></p>
</blockquote>
<p>Analysis of the spatial sub-cellular distribution of proteins is of vital importance to fully understand context specific protein function. Some proteins can be found with a single location within a cell, but up to half of proteins may reside in multiple locations, can dynamically relocalise, or reside within an unknown functional compartment. These considerations lead to uncertainty in associating a protein to a single location. Currently, mass spectrometry (MS) based spatial proteomics relies on supervised machine learning algorithms to assign proteins to sub-cellular locations based on common gradient profiles. However, such methods fail to quantify uncertainty associated with sub-cellular class assignment. Here we reformulate the framework on which we perform statistical analysis. We propose a Bayesian generative classifier based on Gaussian mixture models to assign proteins probabilistically to sub-cellular niches, thus proteins have a probability distribution over sub-cellular locations, with Bayesian computation performed using the expectation-maximisation (EM) algorithm (coined TAGM-MAP, for <em>maximum a posteriori</em>), as well as Markov-chain Monte-Carlo (coined TAGM-MCMC). Our methodology allows proteome-wide uncertainty quantification, thus adding a further layer to the analysis of spatial proteomics. Our framework is flexible, allowing many different systems to be analysed and reveals new modelling opportunities for spatial proteomics. We find our methods perform competitively with current state-of-the art machine learning methods, whilst simultaneously providing more information. We highlight several examples where classification based on the support vector machine is unable to make any conclusions, while uncertainty quantification using our approach provides biologically intriguing results. To our knowledge this is the first Bayesian model of MS-based spatial proteomics data.</p>
</div>
<div id="the-tagm-map-method" class="section level1">
<h1 class="hasAnchor">
<a href="#the-tagm-map-method" class="anchor"></a>The <em>TAGM-MAP</em> method</h1>
<p>We will use a subsest of the <code>tan2009r1</code> dataset from the <code>Biocexptpkg("pRolocdata")</code> to illustrate the TAGM-MAP method</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"pRolocdata"</span>)
<span class="kw">data</span>(tan2009r1)
<span class="kw">set.seed</span>(<span class="dv">1</span>)
tan2009r1 &lt;-<span class="st"> </span>tan2009r1[<span class="kw">sample</span>(<span class="kw">nrow</span>(tan2009r1), <span class="dv">400</span>), ]</code></pre></div>
<p>The first step is to generate the model parameters using the <code>tagmMapTrain</code> function, that will generate an instance of class <code>MAPParams</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"pRoloc"</span>)
p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tagm-map.html">tagmMapTrain</a></span>(tan2009r1)
p</code></pre></div>
<pre><code>## Object of class "MAPParams"
##  Method: MAP</code></pre>
<p>The results of the modelling can be visualised with the <code>plotEllipse</code> function. The outer ellipse contains 99% of the total probability whilst the middle and inner ellipses contain 95% and 90% of the probability respectively. The centres of the clusters are represented by black circumpunct (circled dot).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plotEllipse.html">plotEllipse</a></span>(tan2009r1, p)</code></pre></div>
<p><img src="pRoloc-bayesian_files/figure-html/plotEllipse-1.png" width="700"></p>
<p>The <code>MAPParams</code> object can now be used to classify the proteins of unknown localisation using <code>tagmPredict</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tagm-mcmc.html">tagmPredict</a></span>(tan2009r1, p)</code></pre></div>
<p>The new feature variables that are generated are:</p>
<ul>
<li>
<code>tagm.map.allocation</code>: the TAGM-MAP predictions for the most likely protein sub-cellular allocation.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(<span class="kw">fData</span>(res)<span class="op">$</span>tagm.map.allocation)</code></pre></div>
<pre><code>## 
##  Cytoskeleton            ER         Golgi      Lysosome mitochondrion 
##            17            95            24             8            34 
##       Nucleus    Peroxisome            PM    Proteasome  Ribosome 40S 
##            25             3           114            19            30 
##  Ribosome 60S 
##            31</code></pre>
<ul>
<li>
<code>tagm.map.probability</code>: the posterior probability for the protein sub-cellular allocations.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(<span class="kw">fData</span>(res)<span class="op">$</span>tagm.map.probability)</code></pre></div>
<pre><code>##      Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
## 0.0000000 0.0003256 0.0049051 0.2731639 1.0000000 1.0000000</code></pre>
<ul>
<li>
<code>tagm.map.outlier</code>: the probability for that protein to belong to the outlier component rather than any annotated component.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(<span class="kw">fData</span>(res)<span class="op">$</span>tagm.map.outlier)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.0000  0.0000  0.9948  0.7266  0.9996  1.0000</code></pre>
</div>
<div id="the-tagm-mcmc-method" class="section level1">
<h1 class="hasAnchor">
<a href="#the-tagm-mcmc-method" class="anchor"></a>The <em>TAGM-MCMC</em> method</h1>
<p>We will use a subsest of the <code>tan2009r1</code> dataset from the <em><a href="http://bioconductor.org/packages/pRolocdata">pRolocdata</a></em> to illustrate the TAGM-MCMC method</p>
<p>The first step is run two MCMC chains for a few iterations of the algorithm using the <code>tagmMcmcTrain</code> function. This function will generate a object of class <code>MCMCParams</code>. The summary slot of which is currently empty.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"pRoloc"</span>)
p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tagm-mcmc.html">tagmMcmcTrain</a></span>(<span class="dt">object =</span> tan2009r1, <span class="dt">numIter =</span> <span class="dv">3</span>,
                   <span class="dt">burnin =</span> <span class="dv">1</span>, <span class="dt">thin =</span> <span class="dv">1</span>, <span class="dt">numChains =</span> <span class="dv">2</span>)
p</code></pre></div>
<pre><code>## Object of class "MCMCParams"
## Method: TAGM.MCMC 
## Number of chains: 2</code></pre>
<p>Information for each MCMC chain is contained within the chains slot. This information can be accessed manually if need. The function <code>MCMCProcess</code> populates the summary slot of the <code>MCMCParams</code> object</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tagm-mcmc.html">tagmMcmcProcess</a></span>(p)
p</code></pre></div>
<pre><code>## Object of class "MCMCParams"
## Method: TAGM.MCMC 
## Number of chains: 2 
## Summary available</code></pre>
<p>The summary slot has now been populated to include basic summaries of the <code>MCMCChains</code>, such as allocations and localisation probabilities. Protein information can be appended to the feature columns of the <code>MSnSet</code> by using the <code>tagmPredict</code> function, which extracts the required information from the summary slot of the <code>MCMCParams</code> object.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/tagm-mcmc.html">tagmPredict</a></span>(<span class="dt">object =</span> tan2009r1, <span class="dt">params =</span> p)</code></pre></div>
<p>One can access new features variables:</p>
<ul>
<li>
<code>tagm.mcmc.allocation</code>: the TAGM-MCMC prediction for the most likely protein sub-cellular annotation.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(<span class="kw">fData</span>(res)<span class="op">$</span>tagm.mcmc.allocation)</code></pre></div>
<pre><code>## 
##  Cytoskeleton            ER         Golgi      Lysosome mitochondrion 
##            11            98            21            10            39 
##       Nucleus    Peroxisome            PM    Proteasome  Ribosome 40S 
##            25             3           104            29            32 
##  Ribosome 60S 
##            28</code></pre>
<ul>
<li>
<code>tagm.mcmc.probability</code>: the posterior probability for the protein sub-cellular allocations.</li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">summary</span>(<span class="kw">fData</span>(res)<span class="op">$</span>tagm.mcmc.probability)</code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.3465  0.8777  0.9875  0.9041  1.0000  1.0000</code></pre>
<p>As well as other useful summaries of the MCMC methods:</p>
<ul>
<li><p><code>tagm.mcmc.outlier</code> the posterior probability for the protein to belong to the outlier component.</p></li>
<li><p><code>tagm.mcmc.probability.lowerquantile</code> and <code>tagm.mcmc.probability.upperquantile</code> are the lower and upper boundaries to the equi-tailed 95% credible interval of <code>tagm.mcmc.probability</code>.</p></li>
<li><p><code>tagm.mcmc.mean.shannon</code> a Monte-Carlo averaged shannon entropy, which is a measure of uncertainty in the allocations.</p></li>
</ul>
</div>
<div id="session-information" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#session-information" class="anchor"></a>Session information</h1>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sessionInfo</span>()</code></pre></div>
<pre><code>## R Under development (unstable) (2018-04-02 r74505)
## Platform: x86_64-pc-linux-gnu (64-bit)
## Running under: Ubuntu 14.04.5 LTS
## 
## Matrix products: default
## BLAS: /usr/lib/atlas-base/atlas/libblas.so.3.0
## LAPACK: /usr/lib/lapack/liblapack.so.3.0
## 
## locale:
##  [1] LC_CTYPE=en_GB.UTF-8       LC_NUMERIC=C              
##  [3] LC_TIME=en_GB.UTF-8        LC_COLLATE=en_GB.UTF-8    
##  [5] LC_MONETARY=en_GB.UTF-8    LC_MESSAGES=en_GB.UTF-8   
##  [7] LC_PAPER=en_GB.UTF-8       LC_NAME=C                 
##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
## [11] LC_MEASUREMENT=en_GB.UTF-8 LC_IDENTIFICATION=C       
## 
## attached base packages:
## [1] stats4    parallel  stats     graphics  grDevices utils     datasets 
## [8] methods   base     
## 
## other attached packages:
##  [1] pRolocdata_1.19.1    pRoloc_1.21.2        MLInterfaces_1.61.1 
##  [4] cluster_2.0.7-1      annotate_1.59.0      XML_3.98-1.11       
##  [7] AnnotationDbi_1.43.1 IRanges_2.15.13      S4Vectors_0.19.5    
## [10] MSnbase_2.7.1        ProtGenerics_1.13.0  BiocParallel_1.15.5 
## [13] mzR_2.15.1           Rcpp_0.12.17         Biobase_2.41.0      
## [16] BiocGenerics_0.27.0  BiocStyle_2.9.2     
## 
## loaded via a namespace (and not attached):
##   [1] tidyselect_0.2.4      RSQLite_2.1.1         htmlwidgets_1.2      
##   [4] grid_3.6.0            trimcluster_0.1-2     lpSolve_5.6.13       
##   [7] rda_1.0.2-2           munsell_0.4.3         codetools_0.2-15     
##  [10] preprocessCore_1.43.0 withr_2.1.2           colorspace_1.3-2     
##  [13] BiocInstaller_1.31.1  knitr_1.20            geometry_0.3-6       
##  [16] robustbase_0.93-0     dimRed_0.1.0          mzID_1.19.0          
##  [19] mnormt_1.5-5          hwriter_1.3.2         bit64_0.9-7          
##  [22] ggvis_0.4.3           rprojroot_1.3-2       coda_0.19-1          
##  [25] ipred_0.9-6           xfun_0.1              randomForest_4.6-14  
##  [28] diptest_0.75-7        R6_2.2.2              doParallel_1.0.11    
##  [31] flexmix_2.3-14        DRR_0.0.3             bitops_1.0-6         
##  [34] assertthat_0.2.0      promises_1.0.1        scales_0.5.0         
##  [37] nnet_7.3-12           gtable_0.2.0          affy_1.59.0          
##  [40] ddalpha_1.3.3         timeDate_3043.102     rlang_0.2.0          
##  [43] CVST_0.2-1            genefilter_1.63.0     RcppRoll_0.2.2       
##  [46] splines_3.6.0         lazyeval_0.2.1        ModelMetrics_1.1.0   
##  [49] impute_1.55.0         hexbin_1.27.2         broom_0.4.4          
##  [52] yaml_2.1.19           reshape2_1.4.3        abind_1.4-5          
##  [55] threejs_0.3.1         crosstalk_1.0.0       backports_1.1.2      
##  [58] httpuv_1.4.3          caret_6.0-80          tools_3.6.0          
##  [61] lava_1.6.1            bookdown_0.7          psych_1.8.4          
##  [64] ggplot2_2.2.1         affyio_1.51.0         RColorBrewer_1.1-2   
##  [67] proxy_0.4-22          plyr_1.8.4            base64enc_0.1-3      
##  [70] progress_1.1.2        zlibbioc_1.27.0       purrr_0.2.4          
##  [73] RCurl_1.95-4.10       prettyunits_1.0.2     rpart_4.1-13         
##  [76] viridis_0.5.1         sampling_2.8          sfsmisc_1.1-2        
##  [79] LaplacesDemon_16.1.0  fs_1.2.2              magrittr_1.5         
##  [82] pcaMethods_1.73.0     mvtnorm_1.0-8         whisker_0.3-2        
##  [85] mime_0.5              evaluate_0.10.1       xtable_1.8-2         
##  [88] mclust_5.4            gridExtra_2.3         compiler_3.6.0       
##  [91] biomaRt_2.37.1        tibble_1.4.2          crayon_1.3.4         
##  [94] htmltools_0.3.6       segmented_0.5-3.0     later_0.7.2          
##  [97] tidyr_0.8.1           lubridate_1.7.4       DBI_1.0.0            
## [100] magic_1.5-8           MASS_7.3-50           fpc_2.1-11           
## [103] Matrix_1.2-14         vsn_3.49.0            gdata_2.18.0         
## [106] mlbench_2.1-1         bindr_0.1.1           gower_0.1.2          
## [109] igraph_1.2.1          pkgconfig_2.0.1       pkgdown_1.0.0        
## [112] foreign_0.8-70        recipes_0.1.2         MALDIquant_1.17      
## [115] xml2_1.2.0            roxygen2_6.0.1        foreach_1.4.4        
## [118] prodlim_2018.04.18    stringr_1.3.1         digest_0.6.15        
## [121] pls_2.6-0             rmarkdown_1.9         dendextend_1.8.0     
## [124] kernlab_0.9-26        shiny_1.1.0           gtools_3.5.0         
## [127] commonmark_1.5        modeltools_0.2-21     nlme_3.1-137         
## [130] bindrcpp_0.2.2        desc_1.2.0            viridisLite_0.3.0    
## [133] limma_3.37.1          pillar_1.2.2          lattice_0.20-35      
## [136] httr_1.3.1            DEoptimR_1.0-8        survival_2.42-3.1    
## [139] glue_1.2.0            FNN_1.1               gbm_2.1.3            
## [142] prabclus_2.2-6        iterators_1.0.9       bit_1.1-13           
## [145] class_7.3-14          stringi_1.2.2         mixtools_1.1.0       
## [148] blob_1.1.1            memoise_1.1.0         dplyr_0.7.5          
## [151] e1071_1.6-8</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#the-tagm-map-method">The <em>TAGM-MAP</em> method</a></li>
      <li><a href="#the-tagm-mcmc-method">The <em>TAGM-MCMC</em> method</a></li>
      <li><a href="#session-information">Session information</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Laurent Gatto, Lisa Breckels, Oliver Crook.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
